!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Vertebrae=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var Events=_dereq_("./events"),Helpers=_dereq_("./helpers"),extend=Helpers.extend,wrapError=Helpers.wrapError,utils=_dereq_("./utils"),methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"],attributeMethods=["groupBy","countBy","sortBy","indexBy"];module.exports=function(t,e){var i=t&&t._?t._:utils;e=e||t.Model;var r=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},s={add:!0,remove:!0,merge:!0},n={add:!0,remove:!1};return i.extend(r.prototype,Events,{model:e,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,n))},remove:function(t,e){var i=!Array.isArray(t);t=i?[t]:t.slice(),e||(e={});for(var r=0,s=t.length;s>r;r++){var n=t[r]=this.get(t[r]);if(n){var o=this.modelId(n.attributes);null!=o&&delete this._byId[o],delete this._byId[n.cid];var h=this.indexOf(n);this.models.splice(h,1),this.length--,e.silent||(e.index=h,n.trigger("remove",n,this,e)),this._removeReference(n,e)}}return i?t[0]:t},set:function(t,e){e=i.defaults({},e,s),e.parse&&(t=this.parse(t,e));var r=!Array.isArray(t);t=r?t?[t]:[]:t.slice();var n,o,h,l,a,d=e.at;null!=d&&(d=+d),0>d&&(d+=this.length+1);for(var u=this.comparator&&null==d&&e.sort!==!1,c="string"==typeof this.comparator?this.comparator:null,f=[],m=[],p={},v=e.add,g=e.merge,y=e.remove,_=!u&&v&&y?[]:!1,x=!1,b=0,I=t.length;I>b;b++){if(h=t[b],l=this.get(h))y&&(p[l.cid]=!0),g&&h!==l&&(h=this._isModel(h)?h.attributes:h,e.parse&&(h=l.parse(h,e)),l.set(h,e),u&&!a&&l.hasChanged(c)&&(a=!0)),t[b]=l;else if(v){if(o=t[b]=this._prepareModel(h,e),!o)continue;f.push(o),this._addReference(o,e)}o=l||o,o&&(n=this.modelId(o.attributes),!_||!o.isNew()&&p[n]||(_.push(o),x=x||!this.models[b]||o.cid!==this.models[b].cid),p[n]=!0)}if(y){for(var b=0,I=this.length;I>b;b++)p[(o=this.models[b]).cid]||m.push(o);m.length&&this.remove(m,e)}if(f.length||x)if(u&&(a=!0),this.length+=f.length,null!=d)for(var b=0,I=f.length;I>b;b++)this.models.splice(d+b,0,f[b]);else{_&&(this.models.length=0);for(var E=_||f,b=0,I=E.length;I>b;b++)this.models.push(E[b])}if(a&&this.sort({silent:!0}),!e.silent){for(var w=null!=d?i.extend({},e):e,b=0,I=f.length;I>b;b++)null!=d&&(w.index=d+b),(o=f[b]).trigger("add",o,this,w);(a||x)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e=e?i.extend({},e):{};for(var r=0,s=this.models.length;s>r;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return[].slice.apply(this.models,arguments)},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return t&&Object.keys(t).length?this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0}):e?void 0:[]},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(this.comparator.bind(this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.models.map(function(e){return e.get(t)})},fetch:function(t){t=t?i.extend({},t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,r=this;return t.success=function(i){var s=t.reset?"reset":"set";r[s](i,t),e&&e(r,i,t),r.trigger("sync",r,i,t)},wrapError(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.extend({},e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var r=this,s=e.success;e.success=function(t,i){e.wait&&r.add(t,e),s&&s(t,i,e)};var n=t.save(null,e);return n&&n["catch"](function(){}),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.extend({},e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_isModel:function(t){return t instanceof e},_addReference:function(t){this._byId[t.cid]=t;var e=this.modelId(t.attributes);null!=e&&(this._byId[e]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if("add"!==t&&"remove"!==t||i===this){if("destroy"===t&&this.remove(e,r),"change"===t){var s=this.modelId(e.previousAttributes()),n=this.modelId(e.attributes);s!==n&&(null!=s&&delete this._byId[s],null!=n&&(this._byId[n]=e))}this.trigger.apply(this,arguments)}}}),i.each?(i.each(methods,function(t){i[t]&&(r.prototype[t]=function(){var e=[].slice.call(arguments);return e.unshift(this.models),i[t].apply(i,e)})}),i.each(attributeMethods,function(t){i[t]&&(r.prototype[t]=function(e,r){var s=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,s,r)})})):(["forEach","map","filter","some","every","reduce","reduceRight","indexOf","lastIndexOf"].forEach(function(t){r.prototype[t]=function(e,i){return this.models[t](e,i)}}),r.prototype.find=function(t,e){var i;return this.some(function(r,s,n){return t.call(e,r,s,n)?(i=r,!0):void 0}),i},["sortBy"].forEach(function(t){r.prototype[t]=function(e,r){var s="function"==typeof e?e:function(t){return t.get(e)};return i[t](this.models,s,r)}})),r.extend=extend,r}},{"./events":2,"./helpers":3,"./utils":9}],2:[function(_dereq_,module,exports){var Helpers=_dereq_("./helpers"),eventsApi=Helpers.eventsApi,eventSplitter=Helpers.eventSplitter,triggerEvents=Helpers.triggerEvents,_=_dereq_("./utils"),Events={on:function(t,e,i){if(!eventsApi(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!eventsApi(this,"once",t,[e,i])||!e)return this;var n,s=this,r=function(){n||(n=!0,s.off(t,r),e.apply(this,arguments))};return r._callback=e,this.on(t,r,i)},off:function(t,e,i){var n,s,r,h,l,o,v,f;if(!this._events||!eventsApi(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(h=t?[t]:Object.keys(this._events),l=0,o=h.length;o>l;l++)if(t=h[l],r=this._events[t]){if(this._events[t]=n=[],e||i)for(v=0,f=r.length;f>v;v++)s=r[v],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&n.push(s);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=[].slice.call(arguments,1);if(!eventsApi(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&triggerEvents(i,e),n&&triggerEvents(n,arguments),this},listenTo:function(t,e,i){var n=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=_.uniqueId("l"));return n[s]=t,i||"object"!=typeof e||(i=this),t.on(e,i,this),this},listenToOnce:function(t,e,i){if("object"==typeof e){for(var n in e)this.listenToOnce(t,n,e[n]);return this}if(eventSplitter.test(e)){for(var s=e.split(eventSplitter),r=0,h=s.length;h>r;r++)this.listenToOnce(t,s[r],i);return this}if(!i)return this;var l=_.once(function(){this.stopListening(t,e,l),i.apply(this,arguments)});return l._callback=i,this.listenTo(t,e,l)},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var r in n)t=n[r],t.off(e,i,this),(s||!Object.keys(t._events).length)&&delete this._listeningTo[r];return this}};Events.bind=Events.on,Events.unbind=Events.off,module.exports=Events},{"./helpers":3,"./utils":9}],3:[function(_dereq_,module,exports){var _=_dereq_("./utils"),eventSplitter=/\s+/,eventsApi=function(r,t,e,n){if(!e)return!0;if("object"==typeof e){for(var o in e)r[t].apply(r,[o,e[o]].concat(n));return!1}if(eventSplitter.test(e)){for(var c=e.split(eventSplitter),i=0,u=c.length;u>i;i++)r[t].apply(r,[c[i]].concat(n));return!1}return!0},triggerEvents=function(r,t){var e,n=-1,o=r.length,c=t[0],i=t[1],u=t[2];switch(t.length){case 0:for(;++n<o;)(e=r[n]).callback.call(e.ctx);return;case 1:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c);return;case 2:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c,i);return;case 3:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c,i,u);return;default:for(;++n<o;)(e=r[n]).callback.apply(e.ctx,t);return}},extend=function(r,t){var e,n=this;e=r&&_.has(r,"constructor")?r.constructor:function(){return n.apply(this,arguments)},_.extend(e,n,t);var o=function(){this.constructor=e};return o.prototype=n.prototype,e.prototype=new o,r&&_.extend(e.prototype,r),e.__super__=n.prototype,e},urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(r,t){var e=t.error;t.error=function(n){e&&e(r,n,t),r.trigger("error",r,n,t)}},utilExists=function(r){return function(t){return"function"==typeof r[t]}};module.exports={eventsApi:eventsApi,eventSplitter:eventSplitter,extend:extend,triggerEvents:triggerEvents,urlError:urlError,utilExists:utilExists,wrapError:wrapError}},{"./utils":9}],4:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,_=_dereq_("./utils"),History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,pathStripper=/#.*$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=decodeURI(this.location.pathname+this.getSearch()),e=this.root.slice(0,-1);return t.indexOf(e)||(t=t.slice(e.length)),"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._hasPushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(routeStripper,"")},start:function(t){if(History.started)throw new Error("Backbone.history has already been started");if(History.started=!0,this.options=_.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(rootStripper,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!(this._hasHashChange||!this._wantsHashChange||this._wantsPushState&&this._hasPushState)){var s=document.createElement("iframe");s.src="javascript:0",s.style.display="none",s.tabIndex=-1;var i=document.body;this.iframe=i.insertBefore(s,i.firstChild).contentWindow,this.iframe.document.open().close(),this.iframe.location.hash="#"+this.fragment}var h=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._hasPushState?h("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?h("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._hasPushState?t("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),History.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),this.handlers.some(function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!History.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var s=this.root;(""===t||"?"===t.charAt(0))&&(s=s.slice(0,-1)||"/");var i=s+t;if(t=decodeURI(t.replace(pathStripper,"")),this.fragment!==t){if(this.fragment=t,this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe)&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,s){if(s){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),History.extend=extend,module.exports=History},{"./events":2,"./helpers":3,"./utils":9}],5:[function(_dereq_,module,exports){var Events=_dereq_("./events"),History=_dereq_("./history"),utils=_dereq_("./utils");module.exports=function(e,r,t){var i=e.Backbone,n={};n.$=t,n._=r||utils,n.ajax=function(){return n.$.ajax.apply(n.$,arguments)},n.sync=_dereq_("./sync")(n),n.noConflict=function(){return e.Backbone=i,this},n.emulateHTTP=!1,n.emulateJSON=!1;var o=_dereq_("./model")(n),u=_dereq_("./collection")(n,o),s=_dereq_("./view")(n),l=_dereq_("./router")(n);return r.extend(n,Events),n.VERSION="1.1.2",n.history=new History,n.Collection=u,n.Events=Events,n.History=History,n.Model=o,n.Router=l,n.View=s,n}},{"./collection":1,"./events":2,"./history":4,"./model":6,"./router":7,"./sync":8,"./utils":9,"./view":10}],6:[function(_dereq_,module,exports){var Events=_dereq_("./events"),Helpers=_dereq_("./helpers"),extend=Helpers.extend,urlError=Helpers.urlError,wrapError=Helpers.wrapError,utils=_dereq_("./utils"),modelMethods=["keys","values","pairs","invert","pick","omit","chain","isEmpty"];module.exports=function(t){var e=t&&t._?t._:utils,i=function(t,i){var r=t||{};i||(i={}),this.cid=e.uniqueId("c"),this.attributes={},i.collection&&(this.collection=i.collection),i.parse&&(r=this.parse(r,i)||{}),r=e.defaults({},r,e.result(this,"defaults")),this.set(r,i),this.changed={},this.initialize.apply(this,arguments)};return e.extend(i.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return e.extend({},this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return e.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return e.matches(t)(this.attributes)},set:function(t,i,r){var s,n,u,a,h,c,o,l;if(null==t)return this;if("object"==typeof t?(n=t,r=i):(n={})[t]=i,r||(r={}),!this._validate(n,r))return!1;u=r.unset,h=r.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=e.extend(Object.create(null),this.attributes),this.changed={}),l=this.attributes,o=this._previousAttributes,this.idAttribute in n&&(this.id=n[this.idAttribute]);for(s in n)i=n[s],e.isEqual(l[s],i)||a.push(s),e.isEqual(o[s],i)?delete this.changed[s]:this.changed[s]=i,u?delete l[s]:l[s]=i;if(!h){a.length&&(this._pending=r);for(var d=0,p=a.length;p>d;d++)this.trigger("change:"+a[d],this,l[a[d]],r)}if(c)return this;if(!h)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,i){return this.set(t,void 0,e.extend({},i,{unset:!0}))},clear:function(t){var i={};for(var r in this.attributes)i[r]=void 0;return this.set(i,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!!Object.keys(this.changed).length:e.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?e.extend(Object.create(null),this.changed):!1;var i,r=!1,s=this._changing?this._previousAttributes:this.attributes;for(var n in t)e.isEqual(s[n],i=t[n])||((r||(r={}))[n]=i);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return e.extend(Object.create(null),this._previousAttributes)},fetch:function(t){t=t?e.extend({},t):{},void 0===t.parse&&(t.parse=!0);var i=this,r=t.success;return t.success=function(e){return i.set(i.parse(e,t),t)?(r&&r(i,e,t),void i.trigger("sync",i,e,t)):!1},wrapError(this,t),this.sync("read",this,t)},save:function(t,i,r){var s,n,u,a=this.attributes;if(null==t||"object"==typeof t?(s=t,r=i):(s={})[t]=i,r=e.extend({validate:!0},r),s&&!r.wait){if(!this.set(s,r))return!1}else if(!this._validate(s,r))return!1;s&&r.wait&&(this.attributes=e.extend({},a,s)),void 0===r.parse&&(r.parse=!0);var h=this,c=r.success;return r.success=function(t){h.attributes=a;var i=h.parse(t,r);return r.wait&&(i=e.extend(s||{},i)),i&&"object"==typeof i&&!h.set(i,r)?!1:(c&&c(h,t,r),void h.trigger("sync",h,t,r))},wrapError(this,r),n=this.isNew()?"create":r.patch?"patch":"update","patch"!==n||r.attrs||(r.attrs=s),u=this.sync(n,this,r),s&&r.wait&&(this.attributes=a),u},destroy:function(t){t=t?e.extend({},t):{};var i=this,r=t.success,s=function(){i.stopListening(),i.trigger("destroy",i,i.collection,t)};if(t.success=function(e){(t.wait||i.isNew())&&s(),r&&r(i,e,t),i.isNew()||i.trigger("sync",i,e,t)},this.isNew())return t.success(),!1;wrapError(this,t);var n=this.sync("delete",this,t);return t.wait||s(),n},url:function(){var t=e.result(this,"urlRoot")||e.result(this.collection,"url")||urlError();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},e.extend(t||{},{validate:!0}))},_validate:function(t,i){if(!i.validate||!this.validate)return!0;t=e.extend({},this.attributes,t);var r=this.validationError=this.validate(t,i)||null;return r?(this.trigger("invalid",this,r,e.extend(i,{validationError:r})),!1):!0}}),e.keys&&modelMethods.forEach(function(t){e[t]&&(i.prototype[t]=function(){var i=[].slice.call(arguments);return i.unshift(this.attributes),e[t].apply(e,i)})}),i.extend=extend,i}},{"./events":2,"./helpers":3,"./utils":9}],7:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,_=_dereq_("./utils");module.exports=function(e){e=e||{history:new _dereq_("./history")};var t=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},r=/\((.*?)\)/g,i=/(\(\?)?:\w+/g,n=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return _.extend(t.prototype,Events,{initialize:function(){},route:function(t,r,i){_.isRegExp(t)||(t=this._routeToRegExp(t)),"function"==typeof r&&(i=r,r=""),i||(i=this[r]);var n=this;return e.history.route(t,function(u){var o=n._extractParameters(t,u);n.execute(i,o,r)!==!1&&(n.trigger.apply(n,["route:"+r].concat(o)),n.trigger("route",r,o),e.history.trigger("route",n,r,o))}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(t,r){return e.history.navigate(t,r),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var e,t=Object.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(u,"\\$&").replace(r,"(?:$1)?").replace(i,function(e,t){return t?e:"([^/?]+)"}).replace(n,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return r.map(function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}}),t.extend=extend,t}},{"./events":2,"./helpers":3,"./utils":9}],8:[function(_dereq_,module,exports){var urlError=_dereq_("./helpers").urlError,_=_dereq_("./utils"),methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};module.exports=function(e){return function(t,r,a){var u=methodMap[t];_.defaults(a||(a={}),{emulateHTTP:e.emulateHTTP||!1,emulateJSON:e.emulateJSON||!1});var o={type:u,dataType:"json"};if(a.url||(o.url=_.result(r,"url")||urlError()),null!=a.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(a.attrs||r.toJSON(a))),a.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),a.emulateHTTP&&("PUT"===u||"DELETE"===u||"PATCH"===u)){o.type="POST",a.emulateJSON&&(o.data._method=u);var l=a.beforeSend;a.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",u),l?l.apply(this,arguments):void 0}}"GET"===o.type||a.emulateJSON||(o.processData=!1);var n=a.error;a.error=function(e,t,r){a.textStatus=t,a.errorThrown=r,n&&n.apply(this,arguments)};var d=a.xhr=e.ajax(_.extend(o,a));return r.trigger("request",r,d,a),d}}},{"./helpers":3,"./utils":9}],9:[function(_dereq_,module,exports){var array=[],push=array.push,slice=array.slice,toString={}.toString,idCounter=0,htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},eq=function(t,r,n,e){if(t===r)return 0!==t||1/t==1/r;if(null==t||null==r)return t===r;var u=toString.call(t);if(u!=toString.call(r))return!1;switch(u){case"[object String]":return t==String(r);case"[object Number]":return t!==+t?r!==+r:0===t?1/t===1/r:t===+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if("object"!=typeof t||"object"!=typeof r)return!1;for(var i=n.length;i--;)if(n[i]==t)return e[i]==r;var o=t.constructor,a=r.constructor;if(o!==a&&!("function"==typeof o&&o instanceof o&&"function"==typeof a&&a instanceof a))return!1;n.push(t),e.push(r);var l=0,c=!0;if("[object Array]"===u){if(l=t.length,c=l===r.length)for(;l--&&(c=eq(t[l],r[l],n,e)););}else{for(var s in t)if(utils.has(t,s)&&(l++,!(c=utils.has(r,s)&&eq(t[s],r[s],n,e))))break;if(c){for(s in r)if(utils.has(r,s)&&!l--)break;c=!l}}return n.pop(),e.pop(),c},utils={};utils.result=function(t,r){var n=t?t[r]:void 0;return"function"==typeof n?t[r]():n},utils.defaults=function(t){return slice.call(arguments,1).forEach(function(r){for(var n in r)void 0===t[n]&&(t[n]=r[n])}),t},utils.extend=function(t){return slice.call(arguments,1).forEach(function(r){for(var n in r)t[n]=r[n]}),t},utils.escape=function(t){return null==t?"":String(t).replace(/[&<>"']/g,function(t){return htmlEscapes[t]})},utils.sortBy=function(t,r,n){var e="function"==typeof r?r:function(t){return t[r]};return t.map(function(t,r,u){return{value:t,index:r,criteria:e.call(n,t,r,u)}}).sort(function(t,r){var n=t.criteria,e=r.criteria;if(n!==e){if(n>e||void 0===n)return 1;if(e>n||void 0===e)return-1}return t.index-r.index}).map(function(t){return t.value})},utils.uniqueId=function(t){var r=++idCounter+"";return t?t+r:r},utils.has=function(t,r){return Object.hasOwnProperty.call(t,r)},utils.isEqual=function(t,r){return eq(t,r,[],[])},utils.isRegExp=function(t){return t?"object"==typeof t&&"[object RegExp]"===toString.call(t):!1},utils.pairs=function(t){for(var r=Object.keys(t),n=r.length,e=Array(n),u=0;n>u;u++)e[u]=[r[u],t[r[u]]];return e},utils.matches=function(t){var r=utils.pairs(t),n=r.length;return function(t){if(null==t)return!n;t=new Object(t);for(var e=0;n>e;e++){var u=r[e],i=u[0];if(u[1]!==t[i]||!(i in t))return!1}return!0}},utils.partial=function(t){var r=slice.call(arguments,1);return function(){for(var n=0,e=r.slice(),u=0,i=e.length;i>u;u++)e[u]===_&&(e[u]=arguments[n++]);for(;n<arguments.length;)e.push(arguments[n++]);return t.apply(this,e)}},utils.before=function(t,r){var n;return function(){return--t>0?n=r.apply(this,arguments):r=null,n}},utils.once=utils.partial(utils.before,2),module.exports=utils},{}],10:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,_=_dereq_("./utils");module.exports=function(e){var t=function(e){this.cid=_.uniqueId("view"),e&&Object.keys(e).forEach(function(t){-1!==n.indexOf(t)&&(this[t]=e[t])},this),this._ensureElement(),this.initialize.apply(this,arguments)},i=/^(\S+)\s*(.*)$/,n=["model","collection","el","id","attributes","className","tagName","events"];return _.extend(t.prototype,Events,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(e){if(!e&&!(e=_.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if("function"!=typeof n&&(n=this[e[t]]),n){var s=t.match(i);this.delegate(s[1],s[2],n.bind(this))}}return this},delegate:function(e,t,i){this.$el.on(e+".delegateEvents"+this.cid,t,i)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){this.$el.off(e+".delegateEvents"+this.cid,t,i)},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"));else{var e=_.extend({},_.result(this,"attributes"));this.id&&(e.id=_.result(this,"id")),this.className&&(e["class"]=_.result(this,"className")),this.setElement(this._createElement(_.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.extend=extend,t}},{"./events":2,"./helpers":3,"./utils":9}]},{},[5])(5)});