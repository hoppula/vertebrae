!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Backbone=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var Events=_dereq_("./events"),Helpers=_dereq_("./helpers"),extend=Helpers.extend,wrapError=Helpers.wrapError,_=_dereq_("underscore"),methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"],attributeMethods=["groupBy","countBy","sortBy","indexBy"];module.exports=function(t,e,i){var r=_dereq_("./sync")(t,e,i),s=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,_.extend({silent:!0},e))},n={add:!0,remove:!0,merge:!0},o={add:!0,remove:!1};return _.extend(s.prototype,Events,{model:Model,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return r.apply(this,arguments)},add:function(t,e){return this.set(t,_.extend({merge:!1},e,o))},remove:function(t,e){var i=!isArray(t);t=i?[t]:_.clone(t),e||(e={});for(var r=0,s=t.length;s>r;r++){var n=t[r]=this.get(t[r]);if(n){var o=this.modelId(n.attributes);null!=o&&delete this._byId[o],delete this._byId[n.cid];var h=this.indexOf(n);this.models.splice(h,1),this.length--,e.silent||(e.index=h,n.trigger("remove",n,this,e)),this._removeReference(n,e)}}return i?t[0]:t},set:function(t,e){e=_.defaults({},e,n),e.parse&&(t=this.parse(t,e));var i=!isArray(t);t=i?t?[t]:[]:t.slice();var r,s,o,h,l,a=e.at;null!=a&&(a=+a),0>a&&(a+=this.length+1);for(var d=this.comparator&&null==a&&e.sort!==!1,u=isString(this.comparator)?this.comparator:null,c=[],f=[],m={},p=e.add,v=e.merge,g=e.remove,y=!d&&p&&g?[]:!1,b=!1,x=0,I=t.length;I>x;x++){if(o=t[x],h=this.get(o))g&&(m[h.cid]=!0),v&&o!==h&&(o=this._isModel(o)?o.attributes:o,e.parse&&(o=h.parse(o,e)),h.set(o,e),d&&!l&&h.hasChanged(u)&&(l=!0)),t[x]=h;else if(p){if(s=t[x]=this._prepareModel(o,e),!s)continue;c.push(s),this._addReference(s,e)}s=h||s,s&&(r=this.modelId(s.attributes),!y||!s.isNew()&&m[r]||(y.push(s),b=b||!this.models[x]||s.cid!==this.models[x].cid),m[r]=!0)}if(g){for(var x=0,I=this.length;I>x;x++)m[(s=this.models[x]).cid]||f.push(s);f.length&&this.remove(f,e)}if(c.length||b)if(d&&(l=!0),this.length+=c.length,null!=a)for(var x=0,I=c.length;I>x;x++)this.models.splice(a+x,0,c[x]);else{y&&(this.models.length=0);for(var M=y||c,x=0,I=M.length;I>x;x++)this.models.push(M[x])}if(l&&this.sort({silent:!0}),!e.silent){for(var w=null!=a?_.clone(e):e,x=0,I=c.length;I>x;x++)null!=a&&(w.index=a+x),(s=c[x]).trigger("add",s,this,w);(l||b)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e=e?_.clone(e):{};for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,_.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,_.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,_.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return[].slice.apply(this.models,arguments)},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){var i=i(t);return this[e?"find":"filter"](function(t){return i(t.attributes)})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return invoke(this.models,"get",t)},fetch:function(t){t=t?_.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(r){var s=t.reset?"reset":"set";i[s](r,t),e&&e(i,r,t),i.trigger("sync",i,r,t)},wrapError(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?_.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,s){e.wait&&i.add(t,e),r&&r(t,s,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?_.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_isModel:function(t){return t instanceof Model},_addReference:function(t){this._byId[t.cid]=t;var e=this.modelId(t.attributes);null!=e&&(this._byId[e]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if("add"!==t&&"remove"!==t||i===this){if("destroy"===t&&this.remove(e,r),"change"===t){var s=this.modelId(e.previousAttributes()),n=this.modelId(e.attributes);s!==n&&(null!=s&&delete this._byId[s],null!=n&&(this._byId[n]=e))}this.trigger.apply(this,arguments)}}}),_.each(methods,function(t){_[t]&&(s.prototype[t]=function(){var e=[].slice.call(arguments);return e.unshift(this.models),_[t].apply(_,e)})}),_.each(attributeMethods,function(t){_[t]&&(s.prototype[t]=function(e,i){var r=_.isFunction(e)?e:function(t){return t.get(e)};return _[t](this.models,r,i)})}),s.extend=extend,s}},{"./events":2,"./helpers":3,"./sync":9,underscore:7}],2:[function(_dereq_,module,exports){var Helpers=_dereq_("./helpers"),eventsApi=Helpers.eventsApi,eventSplitter=Helpers.eventSplitter,triggerEvents=Helpers.triggerEvents,_=_dereq_("underscore"),Events={on:function(t,e,n){if(!eventsApi(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!eventsApi(this,"once",t,[e,n])||!e)return this;var i=this,s=_.once(function(){i.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,n)},off:function(t,e,n){if(!this._events||!eventsApi(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(var i=t?[t]:_.keys(this._events),s=0,r=i.length;r>s;s++){t=i[s];var h=this._events[t];if(h)if(e||n){for(var v=[],l=0,o=h.length;o>l;l++){var f=h[l];(e&&e!==f.callback&&e!==f.callback._callback||n&&n!==f.context)&&v.push(f)}v.length?this._events[t]=v:delete this._events[t]}else delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=[].slice.call(arguments,1);if(!eventsApi(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&triggerEvents(n,e),i&&triggerEvents(i,arguments),this},listenTo:function(t,e,n){var i=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=_.uniqueId("l"));return i[s]=t,n||"object"!=typeof e||(n=this),t.on(e,n,this),this},listenToOnce:function(t,e,n){if("object"==typeof e){for(var i in e)this.listenToOnce(t,i,e[i]);return this}if(eventSplitter.test(e)){for(var s=e.split(eventSplitter),r=0,h=s.length;h>r;r++)this.listenToOnce(t,s[r],n);return this}if(!n)return this;var v=_.once(function(){this.stopListening(t,e,v),n.apply(this,arguments)});return v._callback=n,this.listenTo(t,e,v)},stopListening:function(t,e,n){var i=this._listeningTo;if(!i)return this;var s=!e&&!n;n||"object"!=typeof e||(n=this),t&&((i={})[t._listenId]=t);for(var r in i)t=i[r],t.off(e,n,this),(s||_.isEmpty(t._events))&&delete this._listeningTo[r];return this}};Events.bind=Events.on,Events.unbind=Events.off,module.exports=Events},{"./helpers":3,underscore:7}],3:[function(_dereq_,module,exports){var _=_dereq_("underscore"),eventSplitter=/\s+/,eventsApi=function(r,t,e,n){if(!e)return!0;if("object"==typeof e){for(var o in e)r[t].apply(r,[o,e[o]].concat(n));return!1}if(eventSplitter.test(e)){for(var c=e.split(eventSplitter),a=0,l=c.length;l>a;a++)r[t].apply(r,[c[a]].concat(n));return!1}return!0},triggerEvents=function(r,t){var e,n=-1,o=r.length,c=t[0],a=t[1],l=t[2];switch(t.length){case 0:for(;++n<o;)(e=r[n]).callback.call(e.ctx);return;case 1:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c);return;case 2:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c,a);return;case 3:for(;++n<o;)(e=r[n]).callback.call(e.ctx,c,a,l);return;default:for(;++n<o;)(e=r[n]).callback.apply(e.ctx,t);return}},extend=function(r,t){var e,n=this;e=r&&_.has(r,"constructor")?r.constructor:function(){return n.apply(this,arguments)},_.extend(e,n,t);var o=function(){this.constructor=e};return o.prototype=n.prototype,e.prototype=new o,r&&_.extend(e.prototype,r),e.__super__=n.prototype,e},urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(r,t){var e=t.error;t.error=function(n){e&&e(r,n,t),r.trigger("error",r,n,t)}};module.exports={eventsApi:eventsApi,eventSplitter:eventSplitter,extend:extend,triggerEvents:triggerEvents,urlError:urlError,wrapError:wrapError}},{underscore:7}],4:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,_=_dereq_("underscore"),History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,pathStripper=/#.*$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=decodeURI(this.location.pathname+this.getSearch()),e=this.root.slice(0,-1);return t.indexOf(e)||(t=t.slice(e.length)),"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._hasPushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(routeStripper,"")},start:function(t){if(History.started)throw new Error("Backbone.history has already been started");if(History.started=!0,this.options=_.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(rootStripper,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!(this._hasHashChange||!this._wantsHashChange||this._wantsPushState&&this._hasPushState)){var s=document.createElement("iframe");s.src="javascript:0",s.style.display="none",s.tabIndex=-1;var i=document.body;this.iframe=i.insertBefore(s,i.firstChild).contentWindow,this.iframe.document.open().close(),this.iframe.location.hash="#"+this.fragment}var h=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._hasPushState?h("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?h("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._hasPushState?t("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),History.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),_.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!History.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var s=this.root;(""===t||"?"===t.charAt(0))&&(s=s.slice(0,-1)||"/");var i=s+t;if(t=decodeURI(t.replace(pathStripper,"")),this.fragment!==t){if(this.fragment=t,this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe)&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,s){if(s){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),History.extend=extend,module.exports=History},{"./events":2,"./helpers":3,underscore:7}],5:[function(_dereq_,module,exports){var _=_dereq_("underscore"),Events=_dereq_("./events"),History=_dereq_("./history");module.exports=function(e){var r={};r.ajax=function(){return e.ajax.apply(e,arguments)},r.emulateHTTP=!1,r.emulateJSON=!1;{var t=_dereq_("./collection")(r.ajax,r.emulateHTTP,r.emulateJSON),u=_dereq_("./model")(r.ajax,r.emulateHTTP,r.emulateJSON);_dereq_("./view")(e)}r.history=new History;var a=_dereq_("./router")(r.history);return _.extend(r,Events),r.VERSION="1.1.2",r.Collection=t,r.Events=Events,r.History=History,r.Model=u,r.Router=a,r}},{"./collection":1,"./events":2,"./history":4,"./model":6,"./router":8,"./view":10,underscore:7}],6:[function(_dereq_,module,exports){var Events=_dereq_("./events"),Helpers=_dereq_("./helpers"),extend=Helpers.extend,urlError=Helpers.urlError,wrapError=Helpers.wrapError,_=_dereq_("underscore"),modelMethods=["keys","values","pairs","invert","pick","omit","chain","isEmpty"];module.exports=function(t,e,i){var r=_dereq_("./sync")(t,e,i),s=function(t,e){var i=t||{};e||(e={}),this.cid=_.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=_.defaults({},i,_.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};return _.extend(s.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},sync:function(){return r.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return _.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return _.matches(t)(this.attributes)},set:function(t,e,i){var r,s,n,u,a,h,c,o;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;n=i.unset,a=i.silent,u=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=_.clone(this.attributes),this.changed={}),o=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)e=s[r],_.isEqual(o[r],e)||u.push(r),_.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,n?delete o[r]:o[r]=e;if(!a){u.length&&(this._pending=i);for(var l=0,d=u.length;d>l;l++)this.trigger("change:"+u[l],this,o[u[l]],i)}if(h)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,_.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,_.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!_.isEmpty(this.changed):_.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?_.clone(this.changed):!1;var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in t)_.isEqual(r[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(t){t=t?_.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(r){return e.set(e.parse(r,t),t)?(i&&i(e,r,t),void e.trigger("sync",e,r,t)):!1},wrapError(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,s,n,u=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=_.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=_.extend({},u,r)),void 0===i.parse&&(i.parse=!0);var a=this,h=i.success;return i.success=function(t){a.attributes=u;var e=a.parse(t,i);return i.wait&&(e=_.extend(r||{},e)),_.isObject(e)&&!a.set(e,i)?!1:(h&&h(a,t,i),void a.trigger("sync",a,t,i))},wrapError(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"!==s||i.attrs||(i.attrs=r),n=this.sync(s,this,i),r&&i.wait&&(this.attributes=u),n},destroy:function(t){t=t?_.clone(t):{};var e=this,i=t.success,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};if(t.success=function(s){(t.wait||e.isNew())&&r(),i&&i(e,s,t),e.isNew()||e.trigger("sync",e,s,t)},this.isNew())return t.success(),!1;wrapError(this,t);var s=this.sync("delete",this,t);return t.wait||r(),s},url:function(){var t=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},_.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=_.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,_.extend(e,{validationError:i})),!1):!0}}),_.each(modelMethods,function(t){_[t]&&(s.prototype[t]=function(){var e=slice.call(arguments);return e.unshift(this.attributes),_[t].apply(_,e)})}),s.extend=extend,s}},{"./events":2,"./helpers":3,"./sync":9,underscore:7}],7:[function(_dereq_,module,exports){(function(){var n=this,t=n._,r=Array.prototype,e=Object.prototype,u=Function.prototype,i=r.push,a=r.slice,o=r.concat,l=e.toString,c=e.hasOwnProperty,f=Array.isArray,s=Object.keys,p=u.bind,h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):n._=h,h.VERSION="1.7.0";var g=function(n,t,r){if(void 0===t)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}};h.iteratee=function(n,t,r){return null==n?h.identity:h.isFunction(n)?g(n,t,r):h.isObject(n)?h.matches(n):h.property(n)},h.each=h.forEach=function(n,t,r){if(null==n)return n;t=g(t,r);var e,u=n.length;if(u===+u)for(e=0;u>e;e++)t(n[e],e,n);else{var i=h.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},h.map=h.collect=function(n,t,r){if(null==n)return[];t=h.iteratee(t,r);for(var e,u=n.length!==+n.length&&h.keys(n),i=(u||n).length,a=Array(i),o=0;i>o;o++)e=u?u[o]:o,a[o]=t(n[e],e,n);return a};var v="Reduce of empty array with no initial value";h.reduce=h.foldl=h.inject=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length,o=0;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[o++]:o++]}for(;a>o;o++)u=i?i[o]:o,r=t(r,n[u],u,n);return r},h.reduceRight=h.foldr=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[--a]:--a]}for(;a--;)u=i?i[a]:a,r=t(r,n[u],u,n);return r},h.find=h.detect=function(n,t,r){var e;return t=h.iteratee(t,r),h.some(n,function(n,r,u){return t(n,r,u)?(e=n,!0):void 0}),e},h.filter=h.select=function(n,t,r){var e=[];return null==n?e:(t=h.iteratee(t,r),h.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e)},h.reject=function(n,t,r){return h.filter(n,h.negate(h.iteratee(t)),r)},h.every=h.all=function(n,t,r){if(null==n)return!0;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,!t(n[u],u,n))return!1;return!0},h.some=h.any=function(n,t,r){if(null==n)return!1;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,t(n[u],u,n))return!0;return!1},h.contains=h.include=function(n,t){return null==n?!1:(n.length!==+n.length&&(n=h.values(n)),h.indexOf(n,t)>=0)},h.invoke=function(n,t){var r=a.call(arguments,2),e=h.isFunction(t);return h.map(n,function(n){return(e?t:n[t]).apply(n,r)})},h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matches(t))},h.findWhere=function(n,t){return h.find(n,h.matches(t))},h.max=function(n,t,r){var e,u,i=-1/0,a=-1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],e>i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u>a||u===-1/0&&i===-1/0)&&(i=n,a=u)});return i},h.min=function(n,t,r){var e,u,i=1/0,a=1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],i>e&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(a>u||1/0===u&&1/0===i)&&(i=n,a=u)});return i},h.shuffle=function(n){for(var t,r=n&&n.length===+n.length?n:h.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=h.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},h.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=h.values(n)),n[h.random(n.length-1)]):h.shuffle(n).slice(0,Math.max(0,t))},h.sortBy=function(n,t,r){return t=h.iteratee(t,r),h.pluck(h.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index}),"value")};var m=function(n){return function(t,r,e){var u={};return r=h.iteratee(r,e),h.each(t,function(e,i){var a=r(e,i,t);n(u,e,a)}),u}};h.groupBy=m(function(n,t,r){h.has(n,r)?n[r].push(t):n[r]=[t]}),h.indexBy=m(function(n,t,r){n[r]=t}),h.countBy=m(function(n,t,r){h.has(n,r)?n[r]++:n[r]=1}),h.sortedIndex=function(n,t,r,e){r=h.iteratee(r,e,1);for(var u=r(t),i=0,a=n.length;a>i;){var o=i+a>>>1;r(n[o])<u?i=o+1:a=o}return i},h.toArray=function(n){return n?h.isArray(n)?a.call(n):n.length===+n.length?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:n.length===+n.length?n.length:h.keys(n).length},h.partition=function(n,t,r){t=h.iteratee(t,r);var e=[],u=[];return h.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},h.first=h.head=h.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:a.call(n,0,t)},h.initial=function(n,t,r){return a.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},h.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:a.call(n,Math.max(n.length-t,0))},h.rest=h.tail=h.drop=function(n,t,r){return a.call(n,null==t||r?1:t)},h.compact=function(n){return h.filter(n,h.identity)};var y=function(n,t,r,e){if(t&&h.every(n,h.isArray))return o.apply(e,n);for(var u=0,a=n.length;a>u;u++){var l=n[u];h.isArray(l)||h.isArguments(l)?t?i.apply(e,l):y(l,t,r,e):r||e.push(l)}return e};h.flatten=function(n,t){return y(n,t,!1,[])},h.without=function(n){return h.difference(n,a.call(arguments,1))},h.uniq=h.unique=function(n,t,r,e){if(null==n)return[];h.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=h.iteratee(r,e));for(var u=[],i=[],a=0,o=n.length;o>a;a++){var l=n[a];if(t)a&&i===l||u.push(l),i=l;else if(r){var c=r(l,a,n);h.indexOf(i,c)<0&&(i.push(c),u.push(l))}else h.indexOf(u,l)<0&&u.push(l)}return u},h.union=function(){return h.uniq(y(arguments,!0,!0,[]))},h.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;u>e;e++){var i=n[e];if(!h.contains(t,i)){for(var a=1;r>a&&h.contains(arguments[a],i);a++);a===r&&t.push(i)}}return t},h.difference=function(n){var t=y(a.call(arguments,1),!0,!0,[]);return h.filter(n,function(n){return!h.contains(t,n)})},h.zip=function(n){if(null==n)return[];for(var t=h.max(arguments,"length").length,r=Array(t),e=0;t>e;e++)r[e]=h.pluck(arguments,e);return r},h.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},h.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=h.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}for(;u>e;e++)if(n[e]===t)return e;return-1},h.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=n.length;for("number"==typeof r&&(e=0>r?e+r+1:Math.min(e,r+1));--e>=0;)if(n[e]===t)return e;return-1},h.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var d=function(){};h.bind=function(n,t){var r,e;if(p&&n.bind===p)return p.apply(n,a.call(arguments,1));if(!h.isFunction(n))throw new TypeError("Bind must be called on a function");return r=a.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(a.call(arguments)));d.prototype=n.prototype;var u=new d;d.prototype=null;var i=n.apply(u,r.concat(a.call(arguments)));return h.isObject(i)?i:u}},h.partial=function(n){var t=a.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===h&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},h.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=h.bind(n[r],n);return n},h.memoize=function(n,t){var r=function(e){var u=r.cache,i=t?t.apply(this,arguments):e;return h.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},h.delay=function(n,t){var r=a.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},h.defer=function(n){return h.delay.apply(h,[n,1].concat(a.call(arguments,1)))},h.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var l=function(){o=r.leading===!1?0:h.now(),a=null,i=n.apply(e,u),a||(e=u=null)};return function(){var c=h.now();o||r.leading!==!1||(o=c);var f=t-(c-o);return e=this,u=arguments,0>=f||f>t?(clearTimeout(a),a=null,o=c,i=n.apply(e,u),a||(e=u=null)):a||r.trailing===!1||(a=setTimeout(l,f)),i}},h.debounce=function(n,t,r){var e,u,i,a,o,l=function(){var c=h.now()-a;t>c&&c>0?e=setTimeout(l,t-c):(e=null,r||(o=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,a=h.now();var c=r&&!e;return e||(e=setTimeout(l,t)),c&&(o=n.apply(i,u),i=u=null),o}},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},h.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},h.before=function(n,t){var r;return function(){return--n>0?r=t.apply(this,arguments):t=null,r}},h.once=h.partial(h.before,2),h.keys=function(n){if(!h.isObject(n))return[];if(s)return s(n);var t=[];for(var r in n)h.has(n,r)&&t.push(r);return t},h.values=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},h.pairs=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},h.invert=function(n){for(var t={},r=h.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},h.functions=h.methods=function(n){var t=[];for(var r in n)h.isFunction(n[r])&&t.push(r);return t.sort()},h.extend=function(n){if(!h.isObject(n))return n;for(var t,r,e=1,u=arguments.length;u>e;e++){t=arguments[e];for(r in t)c.call(t,r)&&(n[r]=t[r])}return n},h.pick=function(n,t,r){var e,u={};if(null==n)return u;if(h.isFunction(t)){t=g(t,r);for(e in n){var i=n[e];t(i,e,n)&&(u[e]=i)}}else{var l=o.apply([],a.call(arguments,1));n=new Object(n);for(var c=0,f=l.length;f>c;c++)e=l[c],e in n&&(u[e]=n[e])}return u},h.omit=function(n,t,r){if(h.isFunction(t))t=h.negate(t);else{var e=h.map(o.apply([],a.call(arguments,1)),String);t=function(n,t){return!h.contains(e,t)}}return h.pick(n,t,r)},h.defaults=function(n){if(!h.isObject(n))return n;for(var t=1,r=arguments.length;r>t;t++){var e=arguments[t];for(var u in e)void 0===n[u]&&(n[u]=e[u])}return n},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n};var b=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var u=l.call(n);if(u!==l.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]===n)return e[i]===t;var a=n.constructor,o=t.constructor;if(a!==o&&"constructor"in n&&"constructor"in t&&!(h.isFunction(a)&&a instanceof a&&h.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c,f;if("[object Array]"===u){if(c=n.length,f=c===t.length)for(;c--&&(f=b(n[c],t[c],r,e)););}else{var s,p=h.keys(n);if(c=p.length,f=h.keys(t).length===c)for(;c--&&(s=p[c],f=h.has(t,s)&&b(n[s],t[s],r,e)););}return r.pop(),e.pop(),f};h.isEqual=function(n,t){return b(n,t,[],[])},h.isEmpty=function(n){if(null==n)return!0;if(h.isArray(n)||h.isString(n)||h.isArguments(n))return 0===n.length;for(var t in n)if(h.has(n,t))return!1;return!0},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=f||function(n){return"[object Array]"===l.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){h["is"+n]=function(t){return l.call(t)==="[object "+n+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return h.has(n,"callee")}),"function"!=typeof/./&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&n!==+n},h.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===l.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return void 0===n
},h.has=function(n,t){return null!=n&&c.call(n,t)},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(n){return function(t){return t[n]}},h.matches=function(n){var t=h.pairs(n),r=t.length;return function(n){if(null==n)return!r;n=new Object(n);for(var e=0;r>e;e++){var u=t[e],i=u[0];if(u[1]!==n[i]||!(i in n))return!1}return!0}},h.times=function(n,t,r){var e=Array(Math.max(0,n));t=g(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=h.invert(_),j=function(n){var t=function(t){return n[t]},r="(?:"+h.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};h.escape=j(_),h.unescape=j(w),h.result=function(n,t){if(null==n)return void 0;var r=n[t];return h.isFunction(r)?n[t]():r};var x=0;h.uniqueId=function(n){var t=++x+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,F=function(n){return"\\"+k[n]};h.template=function(n,t,r){!t&&r&&(t=r),t=h.defaults({},t,h.templateSettings);var e=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,a,o){return i+=n.slice(u,o).replace(O,F),u=o+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(t.variable||"obj","_",i)}catch(o){throw o.source=i,o}var l=function(n){return a.call(this,n,h)},c=t.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},h.chain=function(n){var t=h(n);return t._chain=!0,t};var E=function(n){return this._chain?h(n).chain():n};h.mixin=function(n){h.each(h.functions(n),function(t){var r=h[t]=n[t];h.prototype[t]=function(){var n=[this._wrapped];return i.apply(n,arguments),E.call(this,r.apply(h,n))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],E.call(this,r)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}).call(this)},{}],8:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,History=_dereq_("./history"),_=_dereq_("underscore");module.exports=function(e){e=e||new History;var t=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},r=/\((.*?)\)/g,n=/(\(\?)?:\w+/g,i=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return _.extend(t.prototype,Events,{initialize:function(){},route:function(t,r,n){_.isRegExp(t)||(t=this._routeToRegExp(t)),_.isFunction(r)&&(n=r,r=""),n||(n=this[r]);var i=this;return e.route(t,function(u){var o=i._extractParameters(t,u);i.execute(n,o,r)!==!1&&(i.trigger.apply(i,["route:"+r].concat(o)),i.trigger("route",r,o),e.trigger("route",i,r,o))}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(t,r){return e.navigate(t,r),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var e,t=_.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(u,"\\$&").replace(r,"(?:$1)?").replace(n,function(e,t){return t?e:"([^/?]+)"}).replace(i,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return _.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}}),t.extend=extend,t}},{"./events":2,"./helpers":3,"./history":4,underscore:7}],9:[function(_dereq_,module,exports){var urlError=_dereq_("./helpers").urlError,_=_dereq_("underscore"),methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};module.exports=function(e,r,t){return r=r||!1,t=t||!1,function(a,u,o){var n=methodMap[a];_.defaults(o||(o={}),{emulateHTTP:r,emulateJSON:t});var d={type:n,dataType:"json"};if(o.url||(d.url=_.result(u,"url")||urlError()),null!=o.data||!u||"create"!==a&&"update"!==a&&"patch"!==a||(d.contentType="application/json",d.data=JSON.stringify(o.attrs||u.toJSON(o))),o.emulateJSON&&(d.contentType="application/x-www-form-urlencoded",d.data=d.data?{model:d.data}:{}),o.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){d.type="POST",o.emulateJSON&&(d.data._method=n);var l=o.beforeSend;o.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",n),l?l.apply(this,arguments):void 0}}"GET"===d.type||o.emulateJSON||(d.processData=!1);var p=o.error;o.error=function(e,r,t){o.textStatus=r,o.errorThrown=t,p&&p.apply(this,arguments)};var T=o.xhr=e(_.extend(d,o));return u.trigger("request",u,T,o),T}}},{"./helpers":3,underscore:7}],10:[function(_dereq_,module,exports){var Events=_dereq_("./events"),extend=_dereq_("./helpers").extend,_=_dereq_("underscore");module.exports=function(e){var t=function(e){this.cid=_.uniqueId("view"),e||(e={}),_.extend(this,_.pick(e,n)),this._ensureElement(),this.initialize.apply(this,arguments)},i=/^(\S+)\s*(.*)$/,n=["model","collection","el","id","attributes","className","tagName","events"];return _.extend(t.prototype,Events,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e?t:e(t),this.el=this.$el[0]},delegateEvents:function(e){if(!e&&!(e=_.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(_.isFunction(n)||(n=this[e[t]]),n){var s=t.match(i);this.delegate(s[1],s[2],_.bind(n,this))}}return this},delegate:function(e,t,i){this.$el.on(e+".delegateEvents"+this.cid,t,i)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){this.$el.off(e+".delegateEvents"+this.cid,t,i)},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"));else{var e=_.extend({},_.result(this,"attributes"));this.id&&(e.id=_.result(this,"id")),this.className&&(e["class"]=_.result(this,"className")),this.setElement(this._createElement(_.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.extend=extend,t}},{"./events":2,"./helpers":3,underscore:7}]},{},[5])(5)});